"use strict";(self.webpackChunksnjofkalo_ui=self.webpackChunksnjofkalo_ui||[]).push([[76],{6042:(g,E,a)=>{a.d(E,{m:()=>_});var u=a(1626),m=a(4412),c=a(8810),i=a(6354),n=a(9437),p=a(5312),h=a(4438);let _=(()=>{class s{constructor(t){this.http=t,this.apiUrl=`${p.c.apiUrl}/cart`,this.cartItemsSubject=new m.t([]),this.cartItems$=this.cartItemsSubject.asObservable(),this.httpOptions={headers:new u.Lr({"Content-Type":"application/json"}),withCredentials:!0}}getCart(){return this.http.get(`${this.apiUrl}`,this.httpOptions).pipe((0,i.T)(t=>{if(t&&t.success&&t.data){const e=t.data.items,l=(Array.isArray(e)?e:[]).map(d=>{const o=d.item||{},f={idItem:d.itemId||o.idItem||0,itemCategoryId:o.itemCategoryId||0,sellerUserId:o.sellerUserId??void 0,title:d.itemTitle||o.title||"Unknown Title",description:o.description||"No description available.",stockQuantity:o.stockQuantity||0,price:d.itemPrice||o.price||0,isActive:o.isActive??!1,isFeatured:o.isFeatured??!1,isApproved:o.isApproved??!1,approvedByAdminId:o.approvedByAdminId??void 0,approvalDate:o.approvalDate??void 0,rejectionReason:o.rejectionReason??void 0,itemStatus:o.itemStatus||"Unknown",commissionRate:o.commissionRate??void 0,platformFee:o.platformFee??void 0,createdAt:o.createdAt||(new Date).toISOString(),updatedAt:o.updatedAt||(new Date).toISOString(),images:Array.isArray(o.images)?o.images:[]};return{...d,item:f}});return this.cartItemsSubject.next(l),l}return[]}),(0,n.W)(this.handleError))}addToCart(t,e){return this.http.post(`${this.apiUrl}/items`,{itemId:t,quantity:e},this.httpOptions).pipe((0,i.T)(l=>{if(l.success)return!0;throw new Error(l.message||"Failed to add item to cart")}),(0,n.W)(this.handleError))}updateCartItem(t,e){return this.http.put(`${this.apiUrl}/${t}`,{quantity:e}).pipe((0,i.T)(r=>{const l=this.cartItemsSubject.value,d=l.findIndex(o=>o.idCartItem===t);return-1!==d&&(l[d]=r,this.cartItemsSubject.next([...l])),r}))}removeFromCart(t){return this.http.delete(`${this.apiUrl}/${t}`).pipe((0,i.T)(()=>{this.cartItemsSubject.next(this.cartItemsSubject.value.filter(r=>r.idCartItem!==t))}))}clearCart(){return this.http.delete(`${this.apiUrl}`).pipe((0,i.T)(()=>{this.cartItemsSubject.next([])}))}getCartTotal(){return this.cartItems$.pipe((0,i.T)(t=>t.reduce((e,r)=>e+r.item.price*r.quantity,0)))}handleError(t){let e="An unknown error occurred!";return t.error instanceof ErrorEvent?e=`Error: ${t.error.message}`:(e=`Error Code: ${t.status}\nMessage: ${t.message}`,t.error&&"object"==typeof t.error&&"message"in t.error&&(e=`Error: ${t.error.message}`,t.error.errors&&(e+=`\nDetails: ${JSON.stringify(t.error.errors)}`))),console.error(e),(0,c.$)(()=>new Error(e))}static{this.\u0275fac=function(e){return new(e||s)(h.KVO(u.Qq))}}static{this.\u0275prov=h.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})()},4092:(g,E,a)=>{a.d(E,{_:()=>_});var u=a(1626),m=a(8810),c=a(8141),i=a(6354),n=a(9437),p=a(5312),h=a(4438);let _=(()=>{class s{constructor(t){this.http=t,this.apiUrl=p.c.apiUrl,this.httpOptions={headers:new u.Lr({"Content-Type":"application/json"}),withCredentials:!0}}getItems(t){const e=new URLSearchParams;t.searchQuery&&e.set("title",t.searchQuery),t.categoryId&&e.set("categoryId",t.categoryId.toString()),t.sortBy&&e.set("sortBy",t.sortBy),t.pageNumber&&e.set("pageNumber",t.pageNumber.toString()),t.pageSize&&e.set("pageSize",t.pageSize.toString());const r=`${this.apiUrl}/items?${e.toString()}`;return console.log("Making API call to:",r),this.http.get(r,this.httpOptions).pipe((0,c.M)(l=>{console.log("Raw API response:",l)}),(0,i.T)(l=>{if(l&&l.success&&l.data){const d=l.data;return{items:d.data||[],totalPages:d.totalPages,currentPage:d.pageNumber,totalItems:d.totalCount}}return{items:[],totalPages:1,currentPage:1,totalItems:0}}),(0,n.W)(this.handleError))}getItemById(t){return this.http.get(`${this.apiUrl}/items/${t}`,this.httpOptions).pipe((0,i.T)(e=>{if(e&&e.success&&e.data)return e.data;throw new Error("Failed to get item by ID")}),(0,n.W)(this.handleError))}getFeaturedItems(){return this.http.get(`${this.apiUrl}/items/featured`).pipe((0,i.T)(t=>t&&t.success&&t.data?t.data:[]),(0,n.W)(this.handleError))}createItem(t){return this.http.post(`${this.apiUrl}/items/seller`,t).pipe((0,i.T)(e=>{if(e&&e.success&&e.data)return e.data;throw new Error("Failed to create item")}),(0,n.W)(this.handleError))}updateItem(t,e){return this.http.put(`${this.apiUrl}/items/seller/${t}`,e).pipe((0,i.T)(r=>{if(r&&r.success&&r.data)return r.data;throw new Error("Failed to update item")}),(0,n.W)(this.handleError))}deleteItem(t){return this.http.delete(`${this.apiUrl}/items/seller/${t}`).pipe((0,i.T)(e=>{if(!e||!e.success)throw new Error("Failed to delete item")}),(0,n.W)(this.handleError))}getMyItems(){return this.http.get(`${this.apiUrl}/items/seller/my-items`).pipe((0,i.T)(t=>t&&t.success&&t.data?t.data:[]),(0,n.W)(this.handleError))}getPendingApprovals(t=1,e=20){return this.http.get(`${this.apiUrl}/items/pending-approval?pageNumber=${t}&pageSize=${e}`).pipe((0,i.T)(r=>{if(r&&r.success&&r.data)return{items:r.data.data,totalCount:r.data.totalCount};throw new Error(r?.message||"Failed to load pending approvals")}),(0,n.W)(this.handleError))}approveItem(t,e){return this.http.post(`${this.apiUrl}/items/${t}/approve`,{notes:e}).pipe((0,i.T)(r=>{if(r&&r.success&&r.data)return r.data;throw new Error("Failed to approve item")}),(0,n.W)(this.handleError))}rejectItem(t,e){return this.http.post(`${this.apiUrl}/items/${t}/reject`,{rejectionReason:e,allowResubmission:!0}).pipe((0,i.T)(r=>{if(r&&r.success)return r;throw new Error(r?.message||"Failed to reject item")}),(0,n.W)(this.handleError))}getCategories(){return this.http.get(`${this.apiUrl}/categories`,this.httpOptions).pipe((0,i.T)(t=>t&&t.success&&t.data?t.data:[]),(0,n.W)(this.handleError))}createItemRequest(t){const e={title:t.title,description:t.description,itemCategoryID:t.itemCategoryID,price:t.price,stockQuantity:t.stockQuantity,isActive:!0,isApproved:!1,itemStatus:"Pending",isUserGenerated:!0,needsApproval:!0,agreeToTerms:t.agreeToTerms,desiredCommissionRate:.05,images:t.images?.map(r=>({imageData:r.imageData,fileName:r.fileName,contentType:r.contentType,imageOrder:r.imageOrder}))};return this.http.post(`${this.apiUrl}/items/seller`,e).pipe((0,i.T)(r=>{if(r&&r.success&&r.data)return r.data;throw new Error(r?.message||"Failed to create item request")}),(0,n.W)(this.handleError))}handleError(t){let e="An error occurred";return e=t.error instanceof ErrorEvent?`Error: ${t.error.message}`:`Error Code: ${t.status}\nMessage: ${t.message}`,console.error("API Error:",t),(0,m.$)(()=>new Error(e))}static{this.\u0275fac=function(e){return new(e||s)(h.KVO(u.Qq))}}static{this.\u0275prov=h.jDH({token:s,factory:s.\u0275fac,providedIn:"root"})}}return s})()},4397:(g,E,a)=>{a.d(E,{B:()=>p});var u=a(5312),m=a(8141),c=a(6354),i=a(4438),n=a(1626);let p=(()=>{class h{constructor(s){this.http=s,this.apiUrl=`${u.c.apiUrl}/orders`}createOrder(s){return this.http.post(this.apiUrl,s)}getOrders(){return this.http.get(this.apiUrl)}getOrderById(s){return this.http.get(`${this.apiUrl}/${s}`)}updateOrderStatus(s,I){return this.http.patch(`${this.apiUrl}/${s}/status`,{status:I})}cancelOrder(s){return this.http.post(`${this.apiUrl}/${s}/cancel`,{})}getMyOrders(){return this.http.get(`${this.apiUrl}/my`).pipe((0,m.M)(s=>{}),(0,c.T)(s=>s.data.data))}getMySellerOrders(){return this.http.get(`${this.apiUrl}/seller/my`)}getAllOrders(){return this.http.get(`${this.apiUrl}/admin/all`)}static{this.\u0275fac=function(I){return new(I||h)(i.KVO(n.Qq))}}static{this.\u0275prov=i.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}}return h})()},8599:(g,E,a)=>{a.d(E,{H:()=>m});var u=a(4438);let m=(()=>{class c{transform(n,p=30){return n?n.length<=p?n:n.substring(0,p)+"...":""}static{this.\u0275fac=function(p){return new(p||c)}}static{this.\u0275pipe=u.EJ8({name:"truncate",type:c,pure:!0})}}return c})()},3887:(g,E,a)=>{a.d(E,{G:()=>c});var u=a(177),m=a(4438);let c=(()=>{class i{static{this.\u0275fac=function(h){return new(h||i)}}static{this.\u0275mod=m.$C({type:i})}static{this.\u0275inj=m.G2t({imports:[u.MD]})}}return i})()}}]);